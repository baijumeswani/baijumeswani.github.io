<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OnnxRuntime: Ort::TrainingSession Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156955408-1"></script><script type="text/javascript">"use strict"; window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-156955408-1'); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ONNX_Runtime_logo - Docs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OnnxRuntime
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_ort_1_1_training_session.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="class_ort_1_1_training_session-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Ort::TrainingSession Class Reference<div class="ingroups"><a class="el" href="group___training_cpp.html">Ort Training C++ API</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Trainer class that provides training, evaluation and optimizer methods for training an ONNX models.  
 <a href="class_ort_1_1_training_session.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="onnxruntime__training__cxx__api_8h_source.html">onnxruntime_training_cxx_api.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Ort::TrainingSession:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_ort_1_1_training_session.png" usemap="#Ort::TrainingSession_map" alt=""/>
  <map id="Ort::TrainingSession_map" name="Ort::TrainingSession_map">
<area href="struct_ort_1_1detail_1_1_base.html" alt="Ort::detail::Base&lt; OrtTrainingSession &gt;" shape="rect" coords="0,0,232,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructing the Training Session</div></td></tr>
<tr class="memitem:af36397a61919aa841088a5f17b19160c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#af36397a61919aa841088a5f17b19160c">TrainingSession</a> (const <a class="el" href="struct_ort_1_1_session_options.html">SessionOptions</a> &amp;session_options, <a class="el" href="class_ort_1_1_checkpoint_state.html">CheckpointState</a> &amp;checkpoint_state, const std::basic_string&lt; char &gt; &amp;train_model_path, const std::optional&lt; std::basic_string&lt; char &gt; &gt; &amp;eval_model_path=std::nullopt, const std::optional&lt; std::basic_string&lt; char &gt; &gt; &amp;optimizer_model_path=std::nullopt)</td></tr>
<tr class="memdesc:af36397a61919aa841088a5f17b19160c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a training session that can be used to begin or resume training.  <br /></td></tr>
<tr class="separator:af36397a61919aa841088a5f17b19160c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Implementing The Training Loop</div></td></tr>
<tr class="memitem:a9785fb39a9c7194d0015bb2c9eb74ab6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6">TrainStep</a> (const std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; &amp;input_values)</td></tr>
<tr class="memdesc:a9785fb39a9c7194d0015bb2c9eb74ab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the outputs of the training model and the gradients of the trainable parameters for the given inputs.  <br /></td></tr>
<tr class="separator:a9785fb39a9c7194d0015bb2c9eb74ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d754a8817f5c71170fafb5feebfb8ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a6d754a8817f5c71170fafb5feebfb8ee">LazyResetGrad</a> ()</td></tr>
<tr class="memdesc:a6d754a8817f5c71170fafb5feebfb8ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the gradients of all trainable parameters to zero lazily.  <br /></td></tr>
<tr class="separator:a6d754a8817f5c71170fafb5feebfb8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aca68bdee1e26cd5838ec7da9b2d0c8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a1aca68bdee1e26cd5838ec7da9b2d0c8">EvalStep</a> (const std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; &amp;input_values)</td></tr>
<tr class="memdesc:a1aca68bdee1e26cd5838ec7da9b2d0c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the outputs for the eval model for the given inputs.  <br /></td></tr>
<tr class="separator:a1aca68bdee1e26cd5838ec7da9b2d0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afffbcd32c5c5cd53ee55bd4a463303b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#afffbcd32c5c5cd53ee55bd4a463303b7">SetLearningRate</a> (float learning_rate)</td></tr>
<tr class="memdesc:afffbcd32c5c5cd53ee55bd4a463303b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the learning rate for this training session.  <br /></td></tr>
<tr class="separator:afffbcd32c5c5cd53ee55bd4a463303b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681e7ea539c9a4cf517bed5ef53e7ab4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a681e7ea539c9a4cf517bed5ef53e7ab4">GetLearningRate</a> () const</td></tr>
<tr class="memdesc:a681e7ea539c9a4cf517bed5ef53e7ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current learning rate for this training session.  <br /></td></tr>
<tr class="separator:a681e7ea539c9a4cf517bed5ef53e7ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116e1770b62abe3d3ef3dc9afebcd6a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a116e1770b62abe3d3ef3dc9afebcd6a9">RegisterLinearLRScheduler</a> (int64_t warmup_step_count, int64_t total_step_count, float initial_lr)</td></tr>
<tr class="memdesc:a116e1770b62abe3d3ef3dc9afebcd6a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a linear learning rate scheduler for the training session.  <br /></td></tr>
<tr class="separator:a116e1770b62abe3d3ef3dc9afebcd6a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb39113eb291195701aa15f8ad378a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#aecb39113eb291195701aa15f8ad378a8">SchedulerStep</a> ()</td></tr>
<tr class="memdesc:aecb39113eb291195701aa15f8ad378a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the learning rate based on the registered learing rate scheduler.  <br /></td></tr>
<tr class="separator:aecb39113eb291195701aa15f8ad378a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a065d5a04f04d45af7e2052708c52d21e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a065d5a04f04d45af7e2052708c52d21e">OptimizerStep</a> ()</td></tr>
<tr class="memdesc:a065d5a04f04d45af7e2052708c52d21e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the weight updates for the trainable parameters using the optimizer model.  <br /></td></tr>
<tr class="separator:a065d5a04f04d45af7e2052708c52d21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Prepare For Inferencing</div></td></tr>
<tr class="memitem:a6b407f46787b16b5f789cb472b979ed2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a6b407f46787b16b5f789cb472b979ed2">ExportModelForInferencing</a> (const std::basic_string&lt; char &gt; &amp;inference_model_path, const std::vector&lt; std::string &gt; &amp;graph_output_names)</td></tr>
<tr class="memdesc:a6b407f46787b16b5f789cb472b979ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export a model that can be used for inferencing.  <br /></td></tr>
<tr class="separator:a6b407f46787b16b5f789cb472b979ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Model IO Information</div></td></tr>
<tr class="memitem:a333b95516b40c40bffcf868154c11a9b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a333b95516b40c40bffcf868154c11a9b">InputNames</a> (const bool training)</td></tr>
<tr class="memdesc:a333b95516b40c40bffcf868154c11a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the names of the user inputs for the training and eval models.  <br /></td></tr>
<tr class="separator:a333b95516b40c40bffcf868154c11a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03322a503328d875c301367ab89c584"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#af03322a503328d875c301367ab89c584">OutputNames</a> (const bool training)</td></tr>
<tr class="memdesc:af03322a503328d875c301367ab89c584"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the names of the user outputs for the training and eval models.  <br /></td></tr>
<tr class="separator:af03322a503328d875c301367ab89c584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Accessing The Training Session State</div></td></tr>
<tr class="memitem:a80f2f71bc5f0889957a5cd5f28f004a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ort_1_1_value.html">Value</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#a80f2f71bc5f0889957a5cd5f28f004a8">ToBuffer</a> (const bool only_trainable)</td></tr>
<tr class="memdesc:a80f2f71bc5f0889957a5cd5f28f004a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a contiguous buffer that holds a copy of all training state parameters.  <br /></td></tr>
<tr class="separator:a80f2f71bc5f0889957a5cd5f28f004a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed699e00a7e7c60b591774788f8bb23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_ort_1_1_training_session.html#afed699e00a7e7c60b591774788f8bb23">FromBuffer</a> (<a class="el" href="struct_ort_1_1_value.html">Value</a> &amp;buffer)</td></tr>
<tr class="memdesc:afed699e00a7e7c60b591774788f8bb23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the training session model parameters from a contiguous buffer.  <br /></td></tr>
<tr class="separator:afed699e00a7e7c60b591774788f8bb23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_struct_ort_1_1detail_1_1_base"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_struct_ort_1_1detail_1_1_base')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="struct_ort_1_1detail_1_1_base.html">Ort::detail::Base&lt; OrtTrainingSession &gt;</a></td></tr>
<tr class="memitem:a4e1e8b70ad961418f80b41a4c37429f6 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a4e1e8b70ad961418f80b41a4c37429f6">Base</a> ()=default</td></tr>
<tr class="separator:a4e1e8b70ad961418f80b41a4c37429f6 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8072f7970ea1835bddf9aa5038d972b4 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a8072f7970ea1835bddf9aa5038d972b4">Base</a> (<a class="el" href="struct_ort_1_1detail_1_1_base.html#adac6328b9d9b37cddd94f6b21bebee74">contained_type</a> *p) noexcept</td></tr>
<tr class="separator:a8072f7970ea1835bddf9aa5038d972b4 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f40aacd24f0ba79db2dae8165930498 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a7f40aacd24f0ba79db2dae8165930498">Base</a> (const <a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;)=delete</td></tr>
<tr class="separator:a7f40aacd24f0ba79db2dae8165930498 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ed2c8723bd744b585c65e214156665 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a36ed2c8723bd744b585c65e214156665">Base</a> (<a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;&amp;v) noexcept</td></tr>
<tr class="separator:a36ed2c8723bd744b585c65e214156665 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd548d8facd5ee95fb8f4f4383fb8bf6 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#acd548d8facd5ee95fb8f4f4383fb8bf6">~Base</a> ()</td></tr>
<tr class="separator:acd548d8facd5ee95fb8f4f4383fb8bf6 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f197409cc84018ee2fe04844f188959 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a8f197409cc84018ee2fe04844f188959">operator=</a> (const <a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;)=delete</td></tr>
<tr class="separator:a8f197409cc84018ee2fe04844f188959 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10471dad43b6c80043d0714ae6544c9 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#ab10471dad43b6c80043d0714ae6544c9">operator=</a> (<a class="el" href="struct_ort_1_1detail_1_1_base.html">Base</a> &amp;&amp;v) noexcept</td></tr>
<tr class="separator:ab10471dad43b6c80043d0714ae6544c9 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04e81c6255e5907c49afc2324b80211 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#aa04e81c6255e5907c49afc2324b80211">operator contained_type *</a> () const noexcept</td></tr>
<tr class="separator:aa04e81c6255e5907c49afc2324b80211 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e438d539c77870789686c70b031802 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ort_1_1detail_1_1_base.html#adac6328b9d9b37cddd94f6b21bebee74">contained_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#a77e438d539c77870789686c70b031802">release</a> ()</td></tr>
<tr class="memdesc:a77e438d539c77870789686c70b031802 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Relinquishes ownership of the contained C object pointer The underlying object is not destroyed.  <br /></td></tr>
<tr class="separator:a77e438d539c77870789686c70b031802 inherit pub_methods_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_struct_ort_1_1detail_1_1_base"><td colspan="2" onclick="javascript:toggleInherit('pub_types_struct_ort_1_1detail_1_1_base')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="struct_ort_1_1detail_1_1_base.html">Ort::detail::Base&lt; OrtTrainingSession &gt;</a></td></tr>
<tr class="memitem:adac6328b9d9b37cddd94f6b21bebee74 inherit pub_types_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#adac6328b9d9b37cddd94f6b21bebee74">contained_type</a> = <a class="el" href="group___training_c.html#ga0ce08f1a044096ea60a11fe4380c5a9e">OrtTrainingSession</a></td></tr>
<tr class="separator:adac6328b9d9b37cddd94f6b21bebee74 inherit pub_types_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_struct_ort_1_1detail_1_1_base"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_struct_ort_1_1detail_1_1_base')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="struct_ort_1_1detail_1_1_base.html">Ort::detail::Base&lt; OrtTrainingSession &gt;</a></td></tr>
<tr class="memitem:ac618b65a5500fb65b7419b465cfd3d65 inherit pro_attribs_struct_ort_1_1detail_1_1_base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_ort_1_1detail_1_1_base.html#adac6328b9d9b37cddd94f6b21bebee74">contained_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ort_1_1detail_1_1_base.html#ac618b65a5500fb65b7419b465cfd3d65">p_</a></td></tr>
<tr class="separator:ac618b65a5500fb65b7419b465cfd3d65 inherit pro_attribs_struct_ort_1_1detail_1_1_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Trainer class that provides training, evaluation and optimizer methods for training an ONNX models. </p>
<p>The training session requires four training artifacts</p><ul>
<li>The training onnx model</li>
<li>The evaluation onnx model (optional)</li>
<li>The optimizer onnx model</li>
<li>The checkpoint directory</li>
</ul>
<p>These artifacts can be generated using the <code>onnxruntime-training</code> python <a href="https://github.com/microsoft/onnxruntime/blob/main/orttraining/orttraining/python/training/onnxblock/README.md">utility</a>. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af36397a61919aa841088a5f17b19160c" name="af36397a61919aa841088a5f17b19160c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af36397a61919aa841088a5f17b19160c">&#9670;&#160;</a></span>TrainingSession()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Ort::TrainingSession::TrainingSession </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_ort_1_1_session_options.html">SessionOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>session_options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_ort_1_1_checkpoint_state.html">CheckpointState</a> &amp;&#160;</td>
          <td class="paramname"><em>checkpoint_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::basic_string&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>train_model_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::optional&lt; std::basic_string&lt; char &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>eval_model_path</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::optional&lt; std::basic_string&lt; char &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>optimizer_model_path</em> = <code>std::nullopt</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a training session that can be used to begin or resume training. </p>
<p>This constructor instantiates the training session based on the env and session options provided that can begin or resume training from a given checkpoint state for the given onnx models. The checkpoint state represents the parameters of the training session which will be moved to the device specified by the user through the session options (if necessary).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">session_options</td><td><a class="el" href="struct_ort_1_1_session_options.html" title="Wrapper around OrtSessionOptions.">SessionOptions</a> that the user can customize for this training session. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">checkpoint_state</td><td>Training states that the training session uses as a starting point for training. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">train_model_path</td><td>Model to be used to perform training. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eval_model_path</td><td>Model to be used to perform evaluation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optimizer_model_path</td><td>Model to be used to perform gradient descent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1aca68bdee1e26cd5838ec7da9b2d0c8" name="a1aca68bdee1e26cd5838ec7da9b2d0c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aca68bdee1e26cd5838ec7da9b2d0c8">&#9670;&#160;</a></span>EvalStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; Ort::TrainingSession::EvalStep </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_values</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the outputs for the eval model for the given inputs. </p>
<p>This function performs an eval step that computes the outputs of the eval model for the given inputs. The eval step is performed based on the eval model that was provided to the training session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_values</td><td>The user inputs to the eval model. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A std::vector of <a class="el" href="struct_ort_1_1_value.html" title="Wrapper around OrtValue.">Ort::Value</a> objects that represents the output of the eval pass. </dd></dl>

</div>
</div>
<a id="a6b407f46787b16b5f789cb472b979ed2" name="a6b407f46787b16b5f789cb472b979ed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b407f46787b16b5f789cb472b979ed2">&#9670;&#160;</a></span>ExportModelForInferencing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::ExportModelForInferencing </td>
          <td>(</td>
          <td class="paramtype">const std::basic_string&lt; char &gt; &amp;&#160;</td>
          <td class="paramname"><em>inference_model_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph_output_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export a model that can be used for inferencing. </p>
<p>If the training session was provided with an eval model, the training session can generate an inference model if it knows the inference graph outputs. The input inference graph outputs are used to prune the eval model so that the inference model's outputs align with the provided outputs. The exported model is saved at the path provided and can be used for inferencing with <a class="el" href="struct_ort_1_1_session.html" title="Wrapper around OrtSession.">Ort::Session</a>. </p><dl class="section note"><dt>Note</dt><dd>Note that the function re-loads the eval model from the path provided to <a class="el" href="class_ort_1_1_training_session.html" title="Trainer class that provides training, evaluation and optimizer methods for training an ONNX models.">Ort::TrainingSession</a> and expects that this path still be valid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inference_model_path</td><td>Path where the inference model should be serialized to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">graph_output_names</td><td>Names of the outputs that are needed in the inference model. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afed699e00a7e7c60b591774788f8bb23" name="afed699e00a7e7c60b591774788f8bb23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed699e00a7e7c60b591774788f8bb23">&#9670;&#160;</a></span>FromBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::FromBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_ort_1_1_value.html">Value</a> &amp;&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the training session model parameters from a contiguous buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buffer</td><td>Contiguous buffer to load the parameters from. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a681e7ea539c9a4cf517bed5ef53e7ab4" name="a681e7ea539c9a4cf517bed5ef53e7ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a681e7ea539c9a4cf517bed5ef53e7ab4">&#9670;&#160;</a></span>GetLearningRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float Ort::TrainingSession::GetLearningRate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the current learning rate for this training session. </p>
<p>This function allows users to get the learning rate for the training session. The current learning rate is maintained by the training session, and users can query it for the purpose of implementing their own learning rate schedulers.</p>
<dl class="section return"><dt>Returns</dt><dd>float representing the current learning rate. </dd></dl>

</div>
</div>
<a id="a333b95516b40c40bffcf868154c11a9b" name="a333b95516b40c40bffcf868154c11a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a333b95516b40c40bffcf868154c11a9b">&#9670;&#160;</a></span>InputNames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; Ort::TrainingSession::InputNames </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>training</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the names of the user inputs for the training and eval models. </p>
<p>This function returns the names of inputs of the training or eval model that can be associated with the <a class="el" href="struct_ort_1_1_value.html" title="Wrapper around OrtValue.">Ort::Value(s)</a> provided to the <a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6" title="Computes the outputs of the training model and the gradients of the trainable parameters for the give...">Ort::TrainingSession::TrainStep</a> or <a class="el" href="class_ort_1_1_training_session.html#a1aca68bdee1e26cd5838ec7da9b2d0c8" title="Computes the outputs for the eval model for the given inputs.">Ort::TrainingSession::EvalStep</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">training</td><td>Whether the training model input names are requested or eval model input names. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Graph input names for either the training model or the eval model. </dd></dl>

</div>
</div>
<a id="a6d754a8817f5c71170fafb5feebfb8ee" name="a6d754a8817f5c71170fafb5feebfb8ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d754a8817f5c71170fafb5feebfb8ee">&#9670;&#160;</a></span>LazyResetGrad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::LazyResetGrad </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the gradients of all trainable parameters to zero lazily. </p>
<p>This function sets the internal state of the training session such that the gradients of the trainable parameters in the OrtCheckpointState will be scheduled to be reset just before the new gradients are computed on the next invocation of the next <a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6" title="Computes the outputs of the training model and the gradients of the trainable parameters for the give...">Ort::TrainingSession::TrainStep</a>. </p>

</div>
</div>
<a id="a065d5a04f04d45af7e2052708c52d21e" name="a065d5a04f04d45af7e2052708c52d21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a065d5a04f04d45af7e2052708c52d21e">&#9670;&#160;</a></span>OptimizerStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::OptimizerStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the weight updates for the trainable parameters using the optimizer model. </p>
<p>This function performs the weight update step that updates the trainable parameters such that they take a step in the direction of their gradients (gradient descent). The optimizer step is performed based on the optimizer model that was provided to the training session. The updated parameters are stored inside the training state so that they can be used by the next <a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6" title="Computes the outputs of the training model and the gradients of the trainable parameters for the give...">Ort::TrainingSession::TrainStep</a> function call. </p>

</div>
</div>
<a id="af03322a503328d875c301367ab89c584" name="af03322a503328d875c301367ab89c584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03322a503328d875c301367ab89c584">&#9670;&#160;</a></span>OutputNames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; Ort::TrainingSession::OutputNames </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>training</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the names of the user outputs for the training and eval models. </p>
<p>This function returns the names of outputs of the training or eval model that can be associated with the <a class="el" href="struct_ort_1_1_value.html" title="Wrapper around OrtValue.">Ort::Value(s)</a> returned by the <a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6" title="Computes the outputs of the training model and the gradients of the trainable parameters for the give...">Ort::TrainingSession::TrainStep</a> or <a class="el" href="class_ort_1_1_training_session.html#a1aca68bdee1e26cd5838ec7da9b2d0c8" title="Computes the outputs for the eval model for the given inputs.">Ort::TrainingSession::EvalStep</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">training</td><td>Whether the training model output names are requested or eval model output names. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Graph output names for either the training model or the eval model. </dd></dl>

</div>
</div>
<a id="a116e1770b62abe3d3ef3dc9afebcd6a9" name="a116e1770b62abe3d3ef3dc9afebcd6a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116e1770b62abe3d3ef3dc9afebcd6a9">&#9670;&#160;</a></span>RegisterLinearLRScheduler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::RegisterLinearLRScheduler </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>warmup_step_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>total_step_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>initial_lr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a linear learning rate scheduler for the training session. </p>
<p>Register a linear learning rate scheduler that decays the learning rate by linearly updated multiplicative factor from the initial learning rate set on the training session to 0. The decay is performed after the initial warm up phase where the learning rate is linearly incremented from 0 to the initial learning rate provided.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">warmup_step_count</td><td>Warmup steps for LR warmup. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">total_step_count</td><td>Total step count. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">initial_lr</td><td>The initial learning rate to be used by the training session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aecb39113eb291195701aa15f8ad378a8" name="aecb39113eb291195701aa15f8ad378a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecb39113eb291195701aa15f8ad378a8">&#9670;&#160;</a></span>SchedulerStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::SchedulerStep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the learning rate based on the registered learing rate scheduler. </p>
<p>Takes a scheduler step that updates the learning rate that is being used by the training session. This function should typically be called before invoking the optimizer step for each round, or as determined necessary to update the learning rate being used by the training session. </p><dl class="section note"><dt>Note</dt><dd>Please note that a valid predefined learning rate scheduler must be first registered to invoke this function. </dd></dl>

</div>
</div>
<a id="afffbcd32c5c5cd53ee55bd4a463303b7" name="afffbcd32c5c5cd53ee55bd4a463303b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afffbcd32c5c5cd53ee55bd4a463303b7">&#9670;&#160;</a></span>SetLearningRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Ort::TrainingSession::SetLearningRate </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>learning_rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the learning rate for this training session. </p>
<p>This function allows users to set the learning rate for the training session. The current learning rate is maintained by the training session and can be overwritten by invoking this function with the desired learning rate. This function should not be used when a valid learning rate scheduler is registered. It should be used either to set the learning rate derived from a custom learning rate scheduler or to set a constant learning rate to be used throughout the training session. </p><dl class="section note"><dt>Note</dt><dd>Please note that this function does not set the initial learning rate that may be needed by the predefined learning rate schedulers. To set the initial learning rate for learning rate schedulers, please look at the function <a class="el" href="class_ort_1_1_training_session.html#a116e1770b62abe3d3ef3dc9afebcd6a9" title="Registers a linear learning rate scheduler for the training session.">Ort::TrainingSession::RegisterLinearLRScheduler</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">learning_rate</td><td>Desired learning rate to be set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a80f2f71bc5f0889957a5cd5f28f004a8" name="a80f2f71bc5f0889957a5cd5f28f004a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f2f71bc5f0889957a5cd5f28f004a8">&#9670;&#160;</a></span>ToBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_ort_1_1_value.html">Value</a> Ort::TrainingSession::ToBuffer </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>only_trainable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a contiguous buffer that holds a copy of all training state parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">only_trainable</td><td>Whether to only copy trainable parameters or to copy all parameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Contiguous buffer to the model parameters. </dd></dl>

</div>
</div>
<a id="a9785fb39a9c7194d0015bb2c9eb74ab6" name="a9785fb39a9c7194d0015bb2c9eb74ab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9785fb39a9c7194d0015bb2c9eb74ab6">&#9670;&#160;</a></span>TrainStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; Ort::TrainingSession::TrainStep </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="struct_ort_1_1_value.html">Value</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_values</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the outputs of the training model and the gradients of the trainable parameters for the given inputs. </p>
<p>This function performs a training step that computes the outputs of the training model and the gradients of the trainable parameters for the given inputs. The train step is performed based on the training model that was provided to the training session. The <a class="el" href="class_ort_1_1_training_session.html#a9785fb39a9c7194d0015bb2c9eb74ab6" title="Computes the outputs of the training model and the gradients of the trainable parameters for the give...">Ort::TrainingSession::TrainStep</a> is equivalent of running forward propagation and backward propagation in a single step. The gradients computed are stored inside the training session state so they can be later consumed by the <a class="el" href="class_ort_1_1_training_session.html#a065d5a04f04d45af7e2052708c52d21e" title="Performs the weight updates for the trainable parameters using the optimizer model.">Ort::TrainingSession::OptimizerStep</a> function. The gradients can be lazily reset by invoking the <a class="el" href="class_ort_1_1_training_session.html#a6d754a8817f5c71170fafb5feebfb8ee" title="Reset the gradients of all trainable parameters to zero lazily.">Ort::TrainingSession::LazyResetGrad</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_values</td><td>The user inputs to the training model. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A std::vector of <a class="el" href="struct_ort_1_1_value.html" title="Wrapper around OrtValue.">Ort::Value</a> objects that represents the output of the forward pass of the training model.</dd></dl>
<p><dl class="section return"><dt>Returns</dt><dd>If no error, nullptr will be returned. If there is an error, a pointer to an <a class="el" href="group___global.html#gabbdf49d59489efef1b125d8e0d59adc6">OrtStatus</a> that contains error details will be returned. Use <a class="el" href="struct_ort_api.html#a9b21334e290855a585f53d53dda44551">OrtApi::ReleaseStatus</a> to free this pointer.</dd></dl>
 </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_ort.html">Ort</a></li><li class="navelem"><a class="el" href="class_ort_1_1_training_session.html">TrainingSession</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
